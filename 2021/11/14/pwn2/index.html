<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>teshi</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="pwnå­¦ä¹ ç¬¬ä¸€å¤© 1.é¦–å…ˆå°†pwn2æ–‡ä»¶æ”¾å…¥kalié‡Œè¿›è¡Œfileæ–‡ä»¶æŸ¥è¯¢  123456789file  æŸ¥çœ‹æ–‡ä»¶ç±»å‹ â”Œâ”€â”€(rootğŸ’€kali)-[&#x2F;home&#x2F;dys&#x2F;æ¡Œé¢]â””â”€# file pwn2 pwn2: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter &#x2F;lib">
<meta property="og:type" content="article">
<meta property="og:title" content="teshi">
<meta property="og:url" content="http://socialbiao.github.io/2021/11/14/pwn2/index.html">
<meta property="og:site_name" content="teshi">
<meta property="og:description" content="pwnå­¦ä¹ ç¬¬ä¸€å¤© 1.é¦–å…ˆå°†pwn2æ–‡ä»¶æ”¾å…¥kalié‡Œè¿›è¡Œfileæ–‡ä»¶æŸ¥è¯¢  123456789file  æŸ¥çœ‹æ–‡ä»¶ç±»å‹ â”Œâ”€â”€(rootğŸ’€kali)-[&#x2F;home&#x2F;dys&#x2F;æ¡Œé¢]â””â”€# file pwn2 pwn2: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter &#x2F;lib">
<meta property="og:locale">
<meta property="og:image" content="https://raw.githubusercontent.com/socialbiao/img/main/20211114161756.png">
<meta property="og:image" content="https://raw.githubusercontent.com/socialbiao/img/main/20211114162017.png">
<meta property="og:image" content="https://raw.githubusercontent.com/socialbiao/img/main/20211114162059.png">
<meta property="article:published_time" content="2021-11-14T10:25:37.930Z">
<meta property="article:modified_time" content="2021-11-14T10:34:06.109Z">
<meta property="article:author" content="Socialbiao">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/socialbiao/img/main/20211114161756.png">
  
    <link rel="alternative" href="/atom.xml" title="teshi" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/head2.webp">
  
  
      
<link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  
  <!-- åŠ è½½ç‰¹æ•ˆ -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          rootUrl: '/',
          fancybox: false,
          animate: true,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
<meta name="generator" content="Hexo 5.4.0"></head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/head.jpg" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/" title="Hi Mate"></a></h1>
        </hgroup>

        
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>èœå•</li>
                        <li>æ ‡ç­¾</li>
                        
                        <li>å‹æƒ…é“¾æ¥</li>
                        
                        
                        <li>å…³äºæˆ‘</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">é¦–é¡µ</a></li>
                        
                            <li><a href="/archives">æ–‡ç« åˆ—è¡¨</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl mail" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=n6impqaorK2rq9-u7rH88PI" title="mail">mail</a>
                            
                                <a class="fl github" target="_blank" href="https://github.com/socialbiao" title="github">github</a>
                            
                                <a class="fl zhihu" target="_blank" href="#" title="zhihu">zhihu</a>
                            
                                <a class="fl weibo" target="_blank" href="#" title="weibo">weibo</a>
                            
                                <a class="fl google" target="_blank" href="#" title="google">google</a>
                            
                                <a class="fl twitter" target="_blank" href="#" title="twitter">twitter</a>
                            
                                <a class="fl linkedin" target="_blank" href="#" title="linkedin">linkedin</a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" style="font-size: 10px;">åŠ å¯†è§£å¯†åŸºç¡€çŸ¥è¯†</a> <a href="/tags/%E5%B0%8F%E6%8A%80%E5%B7%A7/" style="font-size: 10px;">å°æŠ€å·§</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 10px;">ç®—æ³•</a>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://xlor.cn">XLor</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://lordcasser.com/">LordCasser</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">ç°å°±è¯»å—äº¬ç†å·¥å¤§å­¦ï¼Œç½‘ç»œå®‰å…¨çˆ±å¥½è€…</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="Me"></a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/head.jpg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="Me"></a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">é¦–é¡µ</a></li>
                
                    <li><a href="/archives">æ–‡ç« åˆ—è¡¨</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="mail" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=n6impqaorK2rq9-u7rH88PI" title="mail">mail</a>
                    
                        <a class="github" target="_blank" href="https://github.com/socialbiao" title="github">github</a>
                    
                        <a class="zhihu" target="_blank" href="#" title="zhihu">zhihu</a>
                    
                        <a class="weibo" target="_blank" href="#" title="weibo">weibo</a>
                    
                        <a class="google" target="_blank" href="#" title="google">google</a>
                    
                        <a class="twitter" target="_blank" href="#" title="twitter">twitter</a>
                    
                        <a class="linkedin" target="_blank" href="#" title="linkedin">linkedin</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-pwn2" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2021/11/14/pwn2/" class="article-date">
      <time datetime="2021-11-14T10:25:37.930Z" itemprop="datePublished">2021-11-14</time>
</a>
    </div>
  
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="pwnå­¦ä¹ ç¬¬ä¸€å¤©"><a href="#pwnå­¦ä¹ ç¬¬ä¸€å¤©" class="headerlink" title="pwnå­¦ä¹ ç¬¬ä¸€å¤©"></a>pwnå­¦ä¹ ç¬¬ä¸€å¤©</h1><p> 1.é¦–å…ˆå°†pwn2æ–‡ä»¶æ”¾å…¥kalié‡Œè¿›è¡Œfileæ–‡ä»¶æŸ¥è¯¢</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">file  æŸ¥çœ‹æ–‡ä»¶ç±»å‹ </span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[/home/dys/æ¡Œé¢]</span><br><span class="line">â””â”€# file pwn2 </span><br><span class="line">pwn2: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=f34393d54019d46d0644bc841469bc31e9d9c370, not stripped</span><br><span class="line"></span><br><span class="line">ä¾‹å¦‚ ELFæ–‡ä»¶æ ¼å¼  äºŒè¿›åˆ¶æ–‡ä»¶æ ¼å¼   GUNç‰ˆæœ¬2.6.32  </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p> 2.è¿›è¡Œchecksec æ–‡ä»¶æŸ¥è¯¢ æŸ¥çœ‹å¼€å¯äº†å“ªäº›ä¿æŠ¤æœºåˆ¶</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> â”€â”€(rootğŸ’€kali)-[/home/dys/æ¡Œé¢]</span><br><span class="line">â””â”€# checksec --file=pwn2                                                 1 â¨¯</span><br><span class="line">RELRO           STACK CANARY      NX            PIE             RPATH      RUNPATH   Symbols         FORTIFY Fortified       Fortifiable     FILE</span><br><span class="line">Partial RELRO   No canary found   NX disabled   No PIE          No RPATH   No RUNPATH   74) Symbols    No    0               2               pwn2         </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<p>RELRO</p>
</blockquote>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Relocation Read-Only (RELRO) æ­¤é¡¹æŠ€æœ¯ä¸»è¦é’ˆå¯¹ GOT æ”¹å†™çš„æ”»å‡»æ–¹å¼ã€‚å®ƒåˆ†ä¸ºä¸¤ç§ï¼ŒPartial RELRO å’Œ Full RELROã€‚</span><br><span class="line">éƒ¨åˆ†RELRO æ˜“å—åˆ°æ”»å‡»ï¼Œä¾‹å¦‚æ”»å‡»è€…å¯ä»¥atoi.gotä¸ºsystem.pltï¼Œè¿›è€Œè¾“å…¥/bin/sh\x00è·å¾—shell</span><br><span class="line">å®Œå…¨RELRO ä½¿æ•´ä¸ª GOT åªè¯»ï¼Œä»è€Œæ— æ³•è¢«è¦†ç›–ï¼Œä½†è¿™æ ·ä¼šå¤§å¤§å¢åŠ ç¨‹åºçš„å¯åŠ¨æ—¶é—´ï¼Œå› ä¸ºç¨‹åºåœ¨å¯åŠ¨ä¹‹å‰éœ€è¦è§£ææ‰€æœ‰çš„ç¬¦å·ã€‚</span><br><span class="line"></span><br><span class="line">gcc -o hello test.c // é»˜è®¤æƒ…å†µä¸‹ï¼Œæ˜¯Partial RELRO</span><br><span class="line">gcc -z norelro -o hello test.c // å…³é—­ï¼Œå³No RELRO</span><br><span class="line">gcc -z lazy -o hello test.c // éƒ¨åˆ†å¼€å¯ï¼Œå³Partial RELRO</span><br><span class="line">gcc -z now -o hello test.c // å…¨éƒ¨å¼€å¯ï¼Œå³Full RELRO</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Stack-canary</p>
</blockquote>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æ ˆæº¢å‡ºä¿æŠ¤æ˜¯ä¸€ç§ç¼“å†²åŒºæº¢å‡ºæ”»å‡»ç¼“è§£æ‰‹æ®µï¼Œå½“å‡½æ•°å­˜åœ¨ç¼“å†²åŒºæº¢å‡ºæ”»å‡»æ¼æ´æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–æ ˆä¸Šçš„è¿”å›åœ°å€æ¥è®©shellcodeèƒ½å¤Ÿå¾—åˆ°æ‰§è¡Œã€‚å½“å¯ç”¨æ ˆä¿æŠ¤åï¼Œå‡½æ•°å¼€å§‹æ‰§è¡Œçš„æ—¶å€™ä¼šå…ˆå¾€æ ˆé‡Œæ’å…¥ç±»ä¼¼cookieçš„ä¿¡æ¯ï¼Œå½“å‡½æ•°çœŸæ­£è¿”å›çš„æ—¶å€™ä¼šéªŒè¯cookieä¿¡æ¯æ˜¯å¦åˆæ³•ï¼Œå¦‚æœä¸åˆæ³•å°±åœæ­¢ç¨‹åºè¿è¡Œã€‚æ”»å‡»è€…åœ¨è¦†ç›–è¿”å›åœ°å€çš„æ—¶å€™å¾€å¾€ä¹Ÿä¼šå°†cookieä¿¡æ¯ç»™è¦†ç›–æ‰ï¼Œå¯¼è‡´æ ˆä¿æŠ¤æ£€æŸ¥å¤±è´¥è€Œé˜»æ­¢shellcodeçš„æ‰§è¡Œã€‚åœ¨Linuxä¸­æˆ‘ä»¬å°†cookieä¿¡æ¯ç§°ä¸ºcanaryã€‚</span><br><span class="line"></span><br><span class="line">gcc -fno-stack-protector -o hello test.c   //ç¦ç”¨æ ˆä¿æŠ¤</span><br><span class="line">gcc -fstack-protector -o hello test.c    //å¯ç”¨å †æ ˆä¿æŠ¤ï¼Œä¸è¿‡åªä¸ºå±€éƒ¨å˜é‡ä¸­å«æœ‰ char æ•°ç»„çš„å‡½æ•°æ’å…¥ä¿æŠ¤ä»£ç </span><br><span class="line">gcc -fstack-protector-all -o hello test.c  //å¯ç”¨å †æ ˆä¿æŠ¤ï¼Œä¸ºæ‰€æœ‰å‡½æ•°æ’å…¥ä¿æŠ¤ä»£ç </span><br></pre></td></tr></table></figure>

<blockquote>
<p>NX<br> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">NX enabledå¦‚æœè¿™ä¸ªä¿æŠ¤å¼€å¯å°±æ˜¯æ„å‘³ç€æ ˆä¸­æ•°æ®æ²¡æœ‰æ‰§è¡Œæƒé™ï¼Œå¦‚æ­¤ä¸€æ¥, å½“æ”»å‡»è€…åœ¨å †æ ˆä¸Šéƒ¨ç½²è‡ªå·±çš„ shellcode å¹¶è§¦å‘æ—¶, åªä¼šç›´æ¥é€ æˆç¨‹åºçš„å´©æºƒï¼Œä½†æ˜¯å¯ä»¥åˆ©ç”¨ropè¿™ç§æ–¹æ³•ç»•è¿‡</span><br><span class="line"></span><br><span class="line">gcc -o  hello test.c // é»˜è®¤æƒ…å†µä¸‹ï¼Œå¼€å¯NXä¿æŠ¤</span><br><span class="line">gcc -z execstack -o  hello test.c // ç¦ç”¨NXä¿æŠ¤</span><br><span class="line">gcc -z noexecstack -o  hello test.c // å¼€å¯NXä¿æŠ¤</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>PIE<br> <figure class="highlight plaintext"><figcaption><span>Executable, ä½ç½®æ— å…³å¯æ‰§è¡Œæ–‡ä»¶)æŠ€æœ¯ä¸ ASLR æŠ€æœ¯ç±»ä¼¼,ASLR å°†ç¨‹åºè¿è¡Œæ—¶çš„å †æ ˆä»¥åŠå…±äº«åº“çš„åŠ è½½åœ°å€éšæœºåŒ–, è€Œ PIE æŠ€æœ¯åˆ™åœ¨ç¼–è¯‘æ—¶å°†ç¨‹åºç¼–è¯‘ä¸ºä½ç½®æ— å…³, å³ç¨‹åºè¿è¡Œæ—¶å„ä¸ªæ®µï¼ˆå¦‚ä»£ç æ®µç­‰ï¼‰åŠ è½½çš„è™šæ‹Ÿåœ°å€ä¹Ÿæ˜¯åœ¨è£…è½½æ—¶æ‰ç¡®å®šã€‚è¿™å°±æ„å‘³ç€, åœ¨ PIE å’Œ ASLR åŒæ—¶å¼€å¯çš„æƒ…å†µä¸‹, æ”»å‡»è€…å°†å¯¹ç¨‹åºçš„å†…å­˜å¸ƒå±€ä¸€æ— æ‰€çŸ¥, ä¼ ç»Ÿçš„æ”¹å†™</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GOT è¡¨é¡¹çš„æ–¹æ³•ä¹Ÿéš¾ä»¥è¿›è¡Œ, å› ä¸ºæ”»å‡»è€…ä¸èƒ½è·å¾—ç¨‹åºçš„.got æ®µçš„è™šåœ°å€ã€‚</span><br><span class="line">è‹¥å¼€å¯ä¸€èˆ¬éœ€åœ¨æ”»å‡»æ—¶æ³„éœ²åœ°å€ä¿¡æ¯</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>RPATH/RUNPATH</p>
</blockquote>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ç¨‹åºè¿è¡Œæ—¶çš„ç¯å¢ƒå˜é‡ï¼Œè¿è¡Œæ—¶æ‰€éœ€è¦çš„å…±äº«åº“æ–‡ä»¶ä¼˜å…ˆä»è¯¥ç›®å½•å¯»æ‰¾ï¼Œå¯ä»¥fake libé€ æˆæ”»å‡»</span><br><span class="line">å®ä¾‹ï¼šhttps://www.contextis.com/en/blog/linux-privilege-escalation-via-dynamically-linked-shared-object-library</span><br></pre></td></tr></table></figure>

<blockquote>
<p>FORTIFY</p>
</blockquote>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">è¿™æ˜¯ä¸€ä¸ªç”±GCCå®ç°çš„æºç çº§åˆ«çš„ä¿æŠ¤æœºåˆ¶ï¼Œå…¶åŠŸèƒ½æ˜¯åœ¨ç¼–è¯‘çš„æ—¶å€™æ£€æŸ¥æºç ä»¥é¿å…æ½œåœ¨çš„ç¼“å†²åŒºæº¢å‡ºç­‰é”™è¯¯ã€‚</span><br><span class="line">ç®€å•åœ°è¯´ï¼ŒåŠ äº†è¿™ä¸ªä¿æŠ¤ä¹‹å,ä¸€äº›æ•æ„Ÿå‡½æ•°å¦‚read, fgets,memcpy, printfç­‰ç­‰å¯èƒ½</span><br><span class="line">å¯¼è‡´æ¼æ´å‡ºç°çš„å‡½æ•°éƒ½ä¼šè¢«æ›¿æ¢æˆ__read_chk,__fgets_chk, __memcpy_chk, __printf_chkç­‰ã€‚</span><br><span class="line">è¿™äº›å¸¦äº†chkçš„å‡½æ•°ä¼šæ£€æŸ¥è¯»å–/å¤åˆ¶çš„å­—èŠ‚é•¿åº¦æ˜¯å¦è¶…è¿‡ç¼“å†²åŒºé•¿åº¦ï¼Œ</span><br><span class="line"></span><br><span class="line">é€šè¿‡æ£€æŸ¥è¯¸å¦‚%nä¹‹ç±»çš„å­—ç¬¦ä¸²ä½ç½®æ˜¯å¦ä½äºå¯èƒ½è¢«ç”¨æˆ·ä¿®æ”¹çš„å¯å†™åœ°å€ï¼Œ</span><br><span class="line">é¿å…äº†æ ¼å¼åŒ–å­—ç¬¦ä¸²è·³è¿‡æŸäº›å‚æ•°ï¼ˆå¦‚ç›´æ¥%7$xï¼‰ç­‰æ–¹å¼æ¥é¿å…æ¼æ´å‡ºç°ã€‚</span><br><span class="line">å¼€å¯äº†FORTIFYä¿æŠ¤çš„ç¨‹åºä¼šè¢«checksecæ£€å‡ºï¼Œæ­¤å¤–ï¼Œåœ¨åæ±‡ç¼–æ—¶ç›´æ¥æŸ¥çœ‹gotè¡¨ä¹Ÿä¼šå‘ç°chkå‡½æ•°çš„å­˜åœ¨</span><br><span class="line">è¿™ç§æ£€æŸ¥æ˜¯é»˜è®¤ä¸å¼€å¯çš„ï¼Œå¯ä»¥é€šè¿‡</span><br></pre></td></tr></table></figure>
<hr>
<p> 3.è¿è¡ŒæŸ¥çœ‹</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~dys/æ¡Œé¢]</span><br><span class="line">â””â”€# ./pwn2          </span><br><span class="line">say something?</span><br><span class="line"></span><br><span class="line">oh,that&#x27;s so boring!</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p> 4.IDAæŸ¥çœ‹</p>
<p> <img src="https://raw.githubusercontent.com/socialbiao/img/main/20211114161756.png"></p>
<p> å¯ä»¥çœ‹åˆ°memsetå‡½æ•°å®šä¹‰sæ˜¯30 å¤§å°<br> ç„¶è€Œåˆ°readå‡½æ•° å®šä¹‰çš„æ˜¯100å¤§å°<br> ç”±æ­¤å¯è§  å­˜åœ¨æ ˆæº¢å‡ºæ¼æ´<br> <img src="https://raw.githubusercontent.com/socialbiao/img/main/20211114162017.png"><br> <img src="https://raw.githubusercontent.com/socialbiao/img/main/20211114162059.png"></p>

      
      
        <div class="page-reward">
          <p><a href="javascript:void(0)" onclick="dashangToggle()" class="dashang">èµ</a></p>
          <div class="hide_box"></div>
          <div class="shang_box">
            <a class="shang_close" href="javascript:void(0)" onclick="dashangToggle()">Ã—</a>
            <div class="shang_tit">
              <p>çº¯å±å¥½ç©</p>
            </div>
            <div class="shang_payimg">
              <img src="/img/alipayimg.jpg" alt="æ‰«ç æ”¯æŒ" title="æ‰«ä¸€æ‰«" />
            </div>
              <div class="pay_explain">æ‰«ç æ‰“èµï¼Œä½ è¯´å¤šå°‘å°±å¤šå°‘</div>
            <div class="shang_payselect">
              
                <div class="pay_item checked" data-id="alipay">
                  <span class="radiobox"></span>
                  <span class="pay_logo"><img src="/img/alipay.png" alt="æ”¯ä»˜å®" /></span>
                </div>
              
              
                <div class="pay_item" data-id="wechat">
                  <span class="radiobox"></span>
                  <span class="pay_logo"><img src="/img/weixin.png" alt="å¾®ä¿¡" /></span>
                </div>
              
            </div>
            <div class="shang_info">
              <p>æ‰“å¼€<span id="shang_pay_txt">æ”¯ä»˜å®</span>æ‰«ä¸€æ‰«ï¼Œå³å¯è¿›è¡Œæ‰«ç æ‰“èµå“¦</p>
            </div>
          </div>
        </div>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js"></script>
        <script type="text/javascript">
          $(".pay_item").click(function(){
            $(this).addClass('checked').siblings('.pay_item').removeClass('checked');
            var dataid=$(this).attr('data-id');
            $(".shang_payimg img").attr("src","/img/"+dataid+"img.jpg");
            $("#shang_pay_txt").text(dataid=="alipay"?"æ”¯ä»˜å®":"å¾®ä¿¡");
          });
          function dashangToggle(){
            
            $(".hide_box").fadeToggle();
            $(".shang_box").fadeToggle();
          }
        </script>
      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>æœ¬æ–‡æ ‡é¢˜:</span><a href="/2021/11/14/pwn2/"></a></p>
        <p><span>æ–‡ç« ä½œè€…:</span><a href="/" title="è®¿é—®  çš„ä¸ªäººåšå®¢"></a></p>
        <p><span>å‘å¸ƒæ—¶é—´:</span>2021å¹´11æœˆ14æ—¥ - 18æ—¶25åˆ†</p>
        <p><span>æœ€åæ›´æ–°:</span>2021å¹´11æœˆ14æ—¥ - 18æ—¶34åˆ†</p>
        <p>
            <span>åŸå§‹é“¾æ¥:</span><a class="post-url" href="/2021/11/14/pwn2/" title="">http://socialbiao.github.io/2021/11/14/pwn2/</a>
            <span class="copy-path" data-clipboard-text="åŸæ–‡: http://socialbiao.github.io/2021/11/14/pwn2/ã€€ã€€ä½œè€…: " title="ç‚¹å‡»å¤åˆ¶æ–‡ç« é“¾æ¥"><i class="fa fa-clipboard"></i></span>
            <script src="/js/clipboard.min.js"></script>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>è®¸å¯åè®®:</span><i class="fa fa-creative-commons"></i> <a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="ä¸­å›½å¤§é™† (CC BY-NC-SA 3.0 CN)" target = "_blank">"ç½²å-éå•†ç”¨-ç›¸åŒæ–¹å¼å…±äº« 3.0"</a> è½¬è½½è¯·ä¿ç•™åŸæ–‡é“¾æ¥åŠä½œè€…ã€‚
        </p>
    </div>



<nav id="article-nav">
  
  
    <a href="/2021/11/13/%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">åŠ å¯†ç®—æ³•</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">æ–‡ç« ç›®å½•</strong>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#pwn%E5%AD%A6%E4%B9%A0%E7%AC%AC%E4%B8%80%E5%A4%A9"><span class="toc-number">1.</span> <span class="toc-text">pwnå­¦ä¹ ç¬¬ä¸€å¤©</span></a></li></ol>
</div>
<input type="button" id="tocButton" value="éšè—ç›®å½•"  title="ç‚¹å‡»æŒ‰é’®éšè—æˆ–è€…æ˜¾ç¤ºæ–‡ç« ç›®å½•">


<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>

<script>
    var valueHide = "éšè—ç›®å½•";
    var valueShow = "æ˜¾ç¤ºç›®å½•";

    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }
    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
        }
    })
    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
    }
</script>





<div class="bdsharebuttonbox">
	<a href="#" class="fx fa-weibo bds_tsina" data-cmd="tsina" title="åˆ†äº«åˆ°æ–°æµªå¾®åš"></a>
	<a href="#" class="fx fa-weixin bds_weixin" data-cmd="weixin" title="åˆ†äº«åˆ°å¾®ä¿¡"></a>
	<a href="#" class="fx fa-qq bds_sqq" data-cmd="sqq" title="åˆ†äº«åˆ°QQå¥½å‹"></a>
	<a href="#" class="fx fa-facebook-official bds_fbook" data-cmd="fbook" title="åˆ†äº«åˆ°Facebook"></a>
	<a href="#" class="fx fa-twitter bds_twi" data-cmd="twi" title="åˆ†äº«åˆ°Twitter"></a>
	<a href="#" class="fx fa-linkedin bds_linkedin" data-cmd="linkedin" title="åˆ†äº«åˆ°linkedin"></a>
	<a href="#" class="fx fa-files-o bds_copy" data-cmd="copy" title="åˆ†äº«åˆ°å¤åˆ¶ç½‘å€"></a>
</div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>




    



    <div class="scroll" id="post-nav-button">
        
            <a href="/" title="å›åˆ°ä¸»é¡µ"><i class="fa fa-home"></i></a>
        
        <a title="æ–‡ç« åˆ—è¡¨"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
        
            <a href="/2021/11/13/%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/" title="ä¸‹ä¸€ç¯‡: åŠ å¯†ç®—æ³•">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>
    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2021/11/14/pwn2/">pwn2</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/11/13/%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/">åŠ å¯†ç®—æ³•</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/11/13/%E6%8C%87%E4%BB%A4/">æŒ‡ä»¤</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/11/13/%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86/">åŠ å¯†è§£å¯†</a></li></ul>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
    <script>
        $(".post-list").addClass("toc-article");
        $(".post-list-item a").attr("target","_blank");
        $("#post-nav-button > a:nth-child(2)").click(function() {
            $(".fa-bars, .fa-times").toggle();
            $(".post-list").toggle(300);
            if ($(".toc").length > 0) {
                $("#toc, #tocButton").toggle(200, function() {
                    if ($(".switch-area").is(":visible")) {
                        $("#tocButton").attr("value", valueHide);
                        }
                    })
            }
            else {
            }
        })
    </script>



    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2021 Socialbiao
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/luuman/hexo-theme-spfk" target="_blank">spfk</a> by luuman
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >æ€»æµè§ˆé‡: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">æœ¬é¡µé˜…è¯»é‡: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>


<script src="/js/main.js"></script>


    <script>
        $(document).ready(function() {
            var backgroundnum = ;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
</body>
</html>