<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>teshi</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="22">
<meta property="og:type" content="website">
<meta property="og:title" content="teshi">
<meta property="og:url" content="http://socialbiao.github.io/index.html">
<meta property="og:site_name" content="teshi">
<meta property="og:description" content="22">
<meta property="og:locale">
<meta property="article:author" content="Socialbiao">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="teshi" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/head2.jpg">
  
  
      
<link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          rootUrl: '/',
          fancybox: false,
          animate: true,
          isHome: true,
          isPost: false,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
<meta name="generator" content="Hexo 5.4.0"></head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/head2.jpg" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/" title="Hi Mate"></a></h1>
        </hgroup>

        
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">首页</a></li>
                        
                            <li><a href="/archives">文章列表</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl mail" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=n6impqaorK2rq9-u7rH88PI" title="mail">mail</a>
                            
                                <a class="fl github" target="_blank" href="https://github.com/socialbiao" title="github">github</a>
                            
                                <a class="fl zhihu" target="_blank" href="#" title="zhihu">zhihu</a>
                            
                                <a class="fl weibo" target="_blank" href="#" title="weibo">weibo</a>
                            
                                <a class="fl google" target="_blank" href="#" title="google">google</a>
                            
                                <a class="fl twitter" target="_blank" href="#" title="twitter">twitter</a>
                            
                                <a class="fl linkedin" target="_blank" href="#" title="linkedin">linkedin</a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" style="font-size: 10px;">加密解密基础知识</a> <a href="/tags/%E5%B0%8F%E6%8A%80%E5%B7%A7/" style="font-size: 10px;">小技巧</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 10px;">算法</a>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://xlor.cn">XLor</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://lordcasser.com/">LordCasser</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">现就读南京理工大学，网络安全爱好者</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="Me"></a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/head2.jpg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="Me"></a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">首页</a></li>
                
                    <li><a href="/archives">文章列表</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="mail" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=n6impqaorK2rq9-u7rH88PI" title="mail">mail</a>
                    
                        <a class="github" target="_blank" href="https://github.com/socialbiao" title="github">github</a>
                    
                        <a class="zhihu" target="_blank" href="#" title="zhihu">zhihu</a>
                    
                        <a class="weibo" target="_blank" href="#" title="weibo">weibo</a>
                    
                        <a class="google" target="_blank" href="#" title="google">google</a>
                    
                        <a class="twitter" target="_blank" href="#" title="twitter">twitter</a>
                    
                        <a class="linkedin" target="_blank" href="#" title="linkedin">linkedin</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap">
  
    <article id="post-加密算法" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2021/11/13/%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/" class="article-date">
      <time datetime="2021-11-13T08:36:42.504Z" itemprop="datePublished">2021-11-13</time>
</a>
    </div>
  
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/11/13/%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/">加密算法</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="Base64¶"><a href="#Base64¶" class="headerlink" title="Base64¶"></a>Base64<a target="_blank" rel="noopener" href="https://wiki.x10sec.org/reverse/identify-encode-encryption/introduction/#base64">¶</a></h2><p>Base64 是一种基于 64 个可打印字符来表示二进制数据的表示方法。转换的时候，将 3 字节的数据，先后放入一个 24 位的缓冲区中，先来的字节占高位。数据不足 3 字节的话，于缓冲器中剩下的比特用 0 补足。每次取出 6 比特，按照其值选择<code>ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/</code>中的字符作为编码后的输出，直到全部输入数据转换完成。</p>
<p>通常而言 Base64 的识别特征为索引表，当我们能找到 <code>ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/</code> 这样索引表，再经过简单的分析基本就能判定是 Base64 编码。</p>
<p>当然，有些题目 base64 的索引表是会变的，一些变种的 base64 主要 就是修改了这个索引表。</p>
<h2 id="Tea¶"><a href="#Tea¶" class="headerlink" title="Tea¶"></a>Tea<a target="_blank" rel="noopener" href="https://wiki.x10sec.org/reverse/identify-encode-encryption/introduction/#tea">¶</a></h2><p>在<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%AF%86%E7%A0%81%E5%AD%A6">密码学</a>中，<strong>微型加密算法</strong>（Tiny Encryption Algorithm，TEA）是一种易于描述和<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/w/index.php?title=%E6%89%A7%E8%A1%8C&action=edit&redlink=1">执行</a>的<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%A1%8A%E5%AF%86%E7%A2%BC">块密码</a>，通常只需要很少的代码就可实现。其设计者是<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%89%91%E6%A1%A5%E5%A4%A7%E5%AD%A6">剑桥大学计算机实验室</a>的<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/w/index.php?title=%E5%A4%A7%E5%8D%AB%C2%B7%E6%83%A0%E5%8B%92&action=edit&redlink=1">大卫 · 惠勒</a>与<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/w/index.php?title=%E7%BD%97%E6%9D%B0%C2%B7%E5%B0%BC%E8%BE%BE%E5%A7%86&action=edit&redlink=1">罗杰 · 尼达姆</a>。</p>
<p>参考代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdint.h&gt;</span><br><span class="line"></span><br><span class="line">void encrypt (uint32_t* v, uint32_t* k) &#123;</span><br><span class="line">    uint32_t v0=v[0], v1=v[1], sum=0, i;           /* set up */</span><br><span class="line">    uint32_t delta=0x9e3779b9;                     /* a key schedule constant */</span><br><span class="line">    uint32_t k0=k[0], k1=k[1], k2=k[2], k3=k[3];   /* cache key */</span><br><span class="line">    for (i=0; i &lt; 32; i++) &#123;                       /* basic cycle start */</span><br><span class="line">        sum += delta;</span><br><span class="line">        v0 += ((v1&lt;&lt;4) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;5) + k1);</span><br><span class="line">        v1 += ((v0&lt;&lt;4) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;5) + k3);  </span><br><span class="line">    &#125;                                              /* end cycle */</span><br><span class="line">    v[0]=v0; v[1]=v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void decrypt (uint32_t* v, uint32_t* k) &#123;</span><br><span class="line">    uint32_t v0=v[0], v1=v[1], sum=0xC6EF3720, i;  /* set up */</span><br><span class="line">    uint32_t delta=0x9e3779b9;                     /* a key schedule constant */</span><br><span class="line">    uint32_t k0=k[0], k1=k[1], k2=k[2], k3=k[3];   /* cache key */</span><br><span class="line">    for (i=0; i&lt;32; i++) &#123;                         /* basic cycle start */</span><br><span class="line">        v1 -= ((v0&lt;&lt;4) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;5) + k3);</span><br><span class="line">        v0 -= ((v1&lt;&lt;4) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;5) + k1);</span><br><span class="line">        sum -= delta;                                   </span><br><span class="line">    &#125;                                              /* end cycle */</span><br><span class="line">    v[0]=v0; v[1]=v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在 Tea 算法中其最主要的识别特征就是 拥有一个 image number ：0x9e3779b9 。当然，这 Tea 算法也有魔改的，感兴趣的可以看 2018 0ctf Quals milk-tea。</p>
<h2 id="RC4¶"><a href="#RC4¶" class="headerlink" title="RC4¶"></a>RC4<a target="_blank" rel="noopener" href="https://wiki.x10sec.org/reverse/identify-encode-encryption/introduction/#rc4">¶</a></h2><p>在<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%AF%86%E7%A2%BC%E5%AD%B8">密码学</a>中，<strong>RC4</strong>（来自 Rivest Cipher 4 的缩写）是一种<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%B5%81%E5%8A%A0%E5%AF%86">流加密</a>算法，<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%AF%86%E9%92%A5">密钥</a>长度可变。它加解密使用相同的密钥，因此也属于<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86">对称加密算法</a>。RC4 是<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%9C%89%E7%B7%9A%E7%AD%89%E6%95%88%E5%8A%A0%E5%AF%86">有线等效加密</a>（WEP）中采用的加密算法，也曾经是 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E4%BC%A0%E8%BE%93%E5%B1%82%E5%AE%89%E5%85%A8%E5%8D%8F%E8%AE%AE">TLS</a> 可采用的算法之一。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">void rc4_init(unsigned char *s, unsigned char *key, unsigned long Len) //初始化函数</span><br><span class="line">&#123;</span><br><span class="line">    int i =0, j = 0;</span><br><span class="line">    char k[256] = &#123;0&#125;;</span><br><span class="line">    unsigned char tmp = 0;</span><br><span class="line">    for (i=0;i&lt;256;i++) &#123;</span><br><span class="line">        s[i] = i;</span><br><span class="line">        k[i] = key[i%Len];</span><br><span class="line">    &#125;</span><br><span class="line">    for (i=0; i&lt;256; i++) &#123;</span><br><span class="line">        j=(j+s[i]+k[i])%256;</span><br><span class="line">        tmp = s[i];</span><br><span class="line">        s[i] = s[j]; //交换s[i]和s[j]</span><br><span class="line">        s[j] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">void rc4_crypt(unsigned char *s, unsigned char *Data, unsigned long Len) //加解密</span><br><span class="line">&#123;</span><br><span class="line">    int i = 0, j = 0, t = 0;</span><br><span class="line">    unsigned long k = 0;</span><br><span class="line">    unsigned char tmp;</span><br><span class="line">    for(k=0;k&lt;Len;k++) &#123;</span><br><span class="line">        i=(i+1)%256;</span><br><span class="line">        j=(j+s[i])%256;</span><br><span class="line">        tmp = s[i];</span><br><span class="line">        s[i] = s[j]; //交换s[x]和s[y]</span><br><span class="line">        s[j] = tmp;</span><br><span class="line">        t=(s[i]+s[j])%256;</span><br><span class="line">        Data[k] ^= s[t];</span><br><span class="line">     &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>通过分析初始化代码，可以看出初始化代码中，对字符数组 s 进行了初始化赋值，且赋值分别递增。之后对 s 进行了 256 次交换操作。通过识别初始化代码，可以知道 rc4 算法。</p>
<p>其伪代码表示为：</p>
<p>初始化长度为 256 的 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/S%E7%9B%92">S 盒</a>。第一个 for 循环将 0 到 255 的互不重复的元素装入 S 盒。第二个 for 循环根据密钥打乱 S 盒。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> for i from 0 to 255</span><br><span class="line">    S[i] := i</span><br><span class="line">endfor</span><br><span class="line">j := 0</span><br><span class="line">for( i=0 ; i&lt;256 ; i++)</span><br><span class="line">    j := (j + S[i] + key[i mod keylength]) % 256</span><br><span class="line">    swap values of S[i] and S[j]</span><br><span class="line">endfor</span><br></pre></td></tr></table></figure>

<p>下面 i,j 是两个指针。每收到一个字节，就进行 while 循环。通过一定的算法（(a),(b)）定位 S 盒中的一个元素，并与输入字节异或，得到 k。循环中还改变了 S 盒（©）。如果输入的是<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%98%8E%E6%96%87">明文</a>，输出的就是<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%AF%86%E6%96%87">密文</a>；如果输入的是密文，输出的就是明文。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">i := 0</span><br><span class="line">j := 0</span><br><span class="line">while GeneratingOutput:</span><br><span class="line">    i := (i + 1) mod 256   //a</span><br><span class="line">    j := (j + S[i]) mod 256 //b</span><br><span class="line">    swap values of S[i] and S[j]  //c</span><br><span class="line">    k := inputByte ^ S[(S[i] + S[j]) % 256]</span><br><span class="line">    output K</span><br><span class="line">endwhile</span><br></pre></td></tr></table></figure>

<p>此算法保证每 256 次循环中 S 盒的每个元素至少被交换过一次</p>
<h2 id="MD5¶"><a href="#MD5¶" class="headerlink" title="MD5¶"></a>MD5<a target="_blank" rel="noopener" href="https://wiki.x10sec.org/reverse/identify-encode-encryption/introduction/#md5">¶</a></h2><p><strong>MD5 消息摘要算法</strong>（英语：MD5 Message-Digest Algorithm），一种被广泛使用的<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%AF%86%E7%A2%BC%E9%9B%9C%E6%B9%8A%E5%87%BD%E6%95%B8">密码散列函数</a>，可以产生出一个 128 位（16 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%AD%97%E8%8A%82">字节</a>）的散列值（hash value），用于确保信息传输完整一致。MD5 由美国密码学家<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E7%BD%97%E7%BA%B3%E5%BE%B7%C2%B7%E6%9D%8E%E7%BB%B4%E6%96%AF%E7%89%B9">罗纳德 · 李维斯特</a>（Ronald Linn Rivest）设计，于 1992 年公开，用以取代 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/MD4">MD4</a> 算法。这套算法的程序在 <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc1321">RFC 1321</a> 中被加以规范。</p>
<p>伪代码表示为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">/Note: All variables are unsigned 32 bits and wrap modulo 2^32 when calculating</span><br><span class="line">var int[64] r, k</span><br><span class="line"></span><br><span class="line">//r specifies the per-round shift amounts</span><br><span class="line">r[ 0..15]：= &#123;7, 12, 17, 22,  7, 12, 17, 22,  7, 12, 17, 22,  7, 12, 17, 22&#125; </span><br><span class="line">r[16..31]：= &#123;5,  9, 14, 20,  5,  9, 14, 20,  5,  9, 14, 20,  5,  9, 14, 20&#125;</span><br><span class="line">r[32..47]：= &#123;4, 11, 16, 23,  4, 11, 16, 23,  4, 11, 16, 23,  4, 11, 16, 23&#125;</span><br><span class="line">r[48..63]：= &#123;6, 10, 15, 21,  6, 10, 15, 21,  6, 10, 15, 21,  6, 10, 15, 21&#125;</span><br><span class="line"></span><br><span class="line">//Use binary integer part of the sines of integers as constants:</span><br><span class="line">for i from 0 to 63</span><br><span class="line">    k[i] := floor(abs(sin(i + 1)) × 2^32)</span><br><span class="line"></span><br><span class="line">//Initialize variables:</span><br><span class="line">var int h0 := 0x67452301</span><br><span class="line">var int h1 := 0xEFCDAB89</span><br><span class="line">var int h2 := 0x98BADCFE</span><br><span class="line">var int h3 := 0x10325476</span><br><span class="line"></span><br><span class="line">//Pre-processing:</span><br><span class="line">append &quot;1&quot; bit to message</span><br><span class="line">append &quot;0&quot; bits until message length in bits ≡ 448 (mod 512)</span><br><span class="line">append bit length of message as 64-bit little-endian integer to message</span><br><span class="line"></span><br><span class="line">//Process the message in successive 512-bit chunks:</span><br><span class="line">for each 512-bit chunk of message</span><br><span class="line">    break chunk into sixteen 32-bit little-endian words w[i], 0 ≤ i ≤ 15</span><br><span class="line"></span><br><span class="line">    //Initialize hash value for this chunk:</span><br><span class="line">    var int a := h0</span><br><span class="line">    var int b := h1</span><br><span class="line">    var int c := h2</span><br><span class="line">    var int d := h3</span><br><span class="line"></span><br><span class="line">    //Main loop:</span><br><span class="line">    for i from 0 to 63</span><br><span class="line">        if 0 ≤ i ≤ 15 then</span><br><span class="line">            f := (b and c) or ((not b) and d)</span><br><span class="line">            g := i</span><br><span class="line">        else if 16 ≤ i ≤ 31</span><br><span class="line">            f := (d and b) or ((not d) and c)</span><br><span class="line">            g := (5×i + 1) mod 16</span><br><span class="line">        else if 32 ≤ i ≤ 47</span><br><span class="line">            f := b xor c xor d</span><br><span class="line">            g := (3×i + 5) mod 16</span><br><span class="line">        else if 48 ≤ i ≤ 63</span><br><span class="line">            f := c xor (b or (not d))</span><br><span class="line">            g := (7×i) mod 16</span><br><span class="line"></span><br><span class="line">        temp := d</span><br><span class="line">        d := c</span><br><span class="line">        c := b</span><br><span class="line">        b := leftrotate((a + f + k[i] + w[g]),r[i]) + b</span><br><span class="line">        a := temp</span><br><span class="line">    Next i</span><br><span class="line">    //Add this chunk&#x27;s hash to result so far:</span><br><span class="line">    h0 := h0 + a</span><br><span class="line">    h1 := h1 + b </span><br><span class="line">    h2 := h2 + c</span><br><span class="line">    h3 := h3 + d</span><br><span class="line">End ForEach</span><br><span class="line">var int digest := h0 append h1 append h2 append h3 //(expressed as little-endian)</span><br></pre></td></tr></table></figure>

<p>其鲜明的特征是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">h0 = 0x67452301;</span><br><span class="line">h1 = 0xefcdab89;</span><br><span class="line">h2 = 0x98badcfe;</span><br><span class="line">h3 = 0x10325476;</span><br></pre></td></tr></table></figure>






      
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-指令" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2021/11/13/%E6%8C%87%E4%BB%A4/" class="article-date">
      <time datetime="2021-11-13T08:36:42.486Z" itemprop="datePublished">2021-11-13</time>
</a>
    </div>
  
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/11/13/%E6%8C%87%E4%BB%A4/">指令</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <blockquote>
<p>在程序上一个jz改为二进制op填充</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">刚刚学到的知识点，分享一下，加壳的进入后要CTRL+G 搜索401000，然后在这里搜索字符串，为什么是这里呢，因为90%的软件加壳都是从这里来解，那剩余部分就得知识更多时候再了解啦。</span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%B0%8F%E6%8A%80%E5%B7%A7/" rel="tag">小技巧</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-加密与解密" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2021/11/13/%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86/" class="article-date">
      <time datetime="2021-11-13T08:36:42.436Z" itemprop="datePublished">2021-11-13</time>
</a>
    </div>
  
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/11/13/%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86/">加密解密</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="第一章基础知识"><a href="#第一章基础知识" class="headerlink" title="第一章基础知识"></a>第一章基础知识</h1><blockquote>
<p>逆向工程内容：</p>
</blockquote>
<ol>
<li>软件使用限制的去除或者软件功能的添加</li>
<li>软件源代码的再获得</li>
<li>硬件的复制和模拟</li>
</ol>
<blockquote>
<p>逆向分析技术（一般途径和策略）</p>
</blockquote>
<ol>
<li>通过软件使用说明和操作格式分析软件（设计思想、编程思路等）</li>
<li> 静态分析技术：根据反汇编得到的程序清单进行分析（常用方法：从提示信息入手进行分析）-&gt;了解各个模块的功能以及编程思路-&gt;工具：IDA</li>
<li>动态分析技术：动态跟踪-&gt;工具：OllyDbg、WinDbg -&gt;原因：<ol>
<li> 模块之间的关联（存在中间结果）、分支和转移</li>
<li> 不依赖系统重定位的初始化程序</li>
<li> 加密变换需要进行解密</li>
</ol>
</li>
</ol>
<blockquote>
<p>Windows运转的核心-&gt;动态链接-&gt;DLL</p>
</blockquote>
<blockquote>
<p>3个主要DLL</p>
</blockquote>
<ol>
<li> Kernel（KERNEL32.DLL）：操作系统核心服务，包括进程与线程管理、内存管理、文件访问等</li>
<li> User（USER32.DLL）：负责处理用户接口，包括键盘和鼠标输入、窗口和菜单管理等</li>
<li> GDI（GDI32.DLL）图形设备接口，允许程序在屏幕和打印机上显示文本和图形</li>
</ol>
<p>Win API中，‘A’表示ANSI，‘W’表示Widechars（Unicode）-&gt;如：MessageBoxA()和MessageBoxW()</p>
<blockquote>
<p>虚拟内存：</p>
</blockquote>
<ol>
<li> 32位进程-&gt;地址空间4GB-&gt;00000000h~FFFFFFFFh</li>
<li> 虚拟内存-&gt;通过映射（Map）可用虚拟地址4GB</li>
<li> Windows-&gt;分时的多任务操作系统-&gt;CPU时间分成时间片-&gt;分配给不同程序-&gt;一个时间片内没每个程序相对独立（自己的4GB寻址空间）</li>
</ol>
<blockquote>
<p>P.S.虚拟内存注意：</p>
</blockquote>
<ol>
<li> 应用程序不会直接访问物理地址</li>
<li> 虚拟内存管理器通过虚拟地址发访问请求来控制控制所有的物理地址访问</li>
<li> 每个应用程序都有独立的4GB寻址空间，不同应用程序的地址空间是彼此隔离的</li>
<li> DLL程序没有“私有”空间，它们总是被映射到其他应用程序的地址空间中，作为其他应用程序的一部分运行 &lt;- 如果DLL不与其他程序处于同一地址空间，应用程序将无法调用它</li>
</ol>
<h1 id="第二章-动态分析技术"><a href="#第二章-动态分析技术" class="headerlink" title="第二章 动态分析技术"></a>第二章 动态分析技术</h1><p>动态分析-&gt;工具：调试器：<br>用户模式：Ring3级，OD、x64dbg、VC++<br>内核模式：WinDbg（能调试操作系统内核）<br>UDD文件：OD的工程文件用于保存但前调试的一些状态</p>
<p>部分代码含义：<br>虚拟地址：一般情况下，同一程序的同一条指令在不同系统环境下此值相同<br>机器码：CPU执行的机器代码<br>汇编指令：与机器码对应的程序代码<br>领空：某一时刻CPU的CS：EIP指向的某段代码的所有者<br>GetDlgItemText：<br>返回值：成功返回文本长度，失败返回0<br>A、W两个版本</p>
<p>阅读代码注意：<br>清楚API定义<br>API函数大都采用_stdcall调用约定（参数从右到左入栈，有被调用者清理栈，返回值放入eax）要分析push指令（将参数入栈）<br>C代码中的子程序采用C调用约定，参数从右到左入栈，由调用者清理栈<br>爆破：通过屏蔽程序的某些功能或改变程序流程是保护的方式失效（如修改跳转指令）</p>
<p>DRx调试寄存器：<br>DR0<del>DR3：调试地址寄存器<br>DR4</del>DR5：保留，未公开具体作用<br>DR6：调试寄存器组状态寄存器<br>DR7：调试寄存器组控制寄存器</p>
<p>常用断点：<br>INT 3断点：<br>bp指令或F2</p>
<p>本质是用INT 3指令替换内容（机器码0xCC，也成CC指令）<br>优点：可以设置无数个<br>缺点：改变机器码，易被API针对检测</p>
<p>硬件断点：<br>右键-&gt;Breakpoint-&gt;Hardware,on execution<br>原理：使用DR0~DR3设定地址，使用DR7设定状态-&gt;最多4个硬件断点<br>优点：速度快，在INT 3断点易被发现处效果好<br>缺点：对多3个断点</p>
<p>内存断点：<br>右键-&gt;Breakpoint-&gt;Memory,on access(write)<br>原理：对所设的地址予以不可访问/不可写属性，产生异常<br>P.S.硬件访问/写入断点是在触发硬件断点的下一条指令处；内存断点是在触发断点的指令处<br>存在代码检验（0xCC）且硬件断点失灵时，可以使用</p>
<p>内存访问一次性断点：<br>Atl+M中显示内存-&gt;相应段上右键-&gt;Set break-on-access<br>中断发生后断点会被删除<br>用于捕捉调用或返回某个模块<br>P.S.此类断点仅在NT架构下可用（Windows的段页式管理）</p>
<p>消息断点：<br>工具栏W -&gt;右键-&gt;Messsge breakpoint on ClassProc<br>调试时，没有合适的断点，可尝试<br>特定窗口函数接收到特定消息时，中断<br>P.S.与INT 3的区别：INT 3在程序启动前设置，消息断点在窗口被创建后才能被设置并拦截消息<br>捕捉断点后在系统代码中，无法使用快捷键（Ctrl/Alt+F9）回到领空-&gt;在内存窗口（M）中对.text区块下断（Set break-on-access）-&gt;F9消息循环处（-&gt;可能不是需要的按钮处理，重复1~2次能达到按钮事件代码处）</p>
<p>条件断点：<br>本质：一个带有条件的INT 3断点<br>使用于寄存器、存储器、消息等</p>
<p>条件记录断点：<br>具有条件断点的作用，同时记录断点处函数表达式或参数的值<br>Logdata窗口记录数据<br>其他调试器部分（暂略）：x64dbg、MDebug、WinDbg（很强大）</p>
<p>断点：1.软件断点：bp 地址或符号 “中断时执行的命令”,bu 符号,bm 通配符 2.硬件断点：ba 3.条件断点：bp xxx “.if(){}.else{}”</p>
<p>bl列出断点，bc删除断点，bd禁止断点，be启用断点，br改变断点编号<br>k查看栈回溯，kb查看栈回溯并显示栈上的前三个参数，kp栈回溯显示参数原型，kv在kb加上调用约定，kd显示栈中的数据</p>
<blockquote>
<p>内存命令：<br>d系列命令查看内存，<br>s - [type] range pattern 在指定内存范围内搜索字符串,[type]表示数据格式，b是byte，w是word，d是dword，a是ascii，u是unicode，默认是b<br>e系列修改内存：两种格式：<br>1.改字符串：e{a|u|za|zu}，za，zu代表以0结尾的ascii和unicode字符串，a，u相反<br>2.改值：e{a|b|d|D|f|q|u|w}</p>
</blockquote>
<blockquote>
<p>查看内存属性：!address [address]</p>
</blockquote>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" rel="tag">加密解密基础知识</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2021 Socialbiao
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/luuman/hexo-theme-spfk" target="_blank">spfk</a> by luuman
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >总浏览量: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>


<script src="/js/main.js"></script>


    <script>
        $(document).ready(function() {
            var backgroundnum = 3;
            var backgroundimg = "url(/background/bg-" + backgroundnum +".jpg)";
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
</body>
</html>